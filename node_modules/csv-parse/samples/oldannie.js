
var fs = require('fs');
var parse = require('..');
// 0 = date
// 1 = open
// 2 = high
// 3 = low
// 4 = close
var parser = parse({delimiter: ','}, function(err, data){
  var len = data.length;
  var stochastic = [];
  // only start analyzing on 3rd day
  for (var i = 3; i < len -1; i++)
  {
        var max = data[i][2];
        var min = data[i][3];
        // calculate high and low of past three days
        for (var j = i -2; j <= i; j++)
        {
            // high
            if(data[j][2] > max)
            {
              max = data[j][2];
            }
            // low
            if(data[j][3] < min)
            {
                min = data[j][3];
            }
        }
        var d = 100 * (max/min);
        stochastic.push(d);
  }
  console.log("len =" + len);
  console.log("n = " + stochastic.length);
  for (var k = 0, n = stochastic.length; k < n; k++)
    {
        console.log("stochastic:" + stochastic[k]);
    }
});

fs.createReadStream(__dirname+'/practice.csv').pipe(parser);
